<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .card {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        .card input, .card button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
        }
        .card button {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        ul { padding-left: 20px; }
        li { margin: 5px 0; }
        .green { color: green; }
        .red { color: red; }
    </style>
</head>
<body>

<nav class="nav">
    {% if 'user' in session %}
        <a href="/">üè† –ì–æ–ª–æ–≤–Ω–∞</a>
        <a href="/stats">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
        <a href="/logout">üö™ –í–∏–π—Ç–∏</a>
    {% else %}
        <a href="/login">üîê –í—Ö—ñ–¥</a>
        <a href="/register">üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
    {% endif %}
</nav>

<div class="container">
<main class="content">
{% if 'user' in session and not stats %}
<h1>üí∞ –û–±–ª—ñ–∫ –±—é–¥–∂–µ—Ç—É</h1>

<!-- üìâ –í–ò–¢–†–ê–¢–ò -->
<div class="card">
    <h2>üìâ –í–∏—Ç—Ä–∞—Ç–∏</h2>
    <form method="POST">
        <input type="hidden" name="type" value="expense">
        <input type="text" name="category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è" required>
        <input type="number" name="suma" placeholder="–°—É–º–∞" required>
        <button type="submit">–î–æ–¥–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç—É</button>
    </form>
    <ul>
        {% for e in expenses %}
            <li class="red">‚àí {{ e.suma }} –≥—Ä–Ω | {{ e.category }}</li>
        {% endfor %}
    </ul>
    <p><b>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –≤–∏—Ç—Ä–∞—Ç: {{ total }} –≥—Ä–Ω</b></p>
</div>

<!-- üìà –î–û–î–ê–¢–ö–û–í–ò–ô –î–û–•–Ü–î -->
<div class="card">
    <h2>üìà –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –¥–æ—Ö—ñ–¥</h2>
    <form method="POST" action="/add-additional-income">
        <input type="text" name="category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –¥–æ—Ö–æ–¥—É" required>
        <input type="number" name="suma" placeholder="–°—É–º–∞" required>
        <button type="submit">–î–æ–¥–∞—Ç–∏ –¥–æ—Ö—ñ–¥</button>
    </form>
    <ul>
        {% for i in additional_income %}
            <li class="green">+ {{ i.suma }} –≥—Ä–Ω | {{ i.category }}</li>
        {% endfor %}
    </ul>
    <p>üíº –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –¥–æ—Ö—ñ–¥: <b>{{ total_additional_income }} –≥—Ä–Ω</b></p>
</div>

{% elif stats %}
<!-- üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div class="card">
    <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º—ñ—Å—è—Ü—è</h2>
    <p>üí∞ –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥: <b>{{ mysterious_income }} –≥—Ä–Ω</b></p>
    <p>üí∏ –í–∏—Ç—Ä–∞—Ç–∏: <b>{{ total_expenses }} –≥—Ä–Ω</b></p>
    <p>üìà –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –¥–æ—Ö—ñ–¥: <b>{{ total_additional_income }} –≥—Ä–Ω</b></p>
    <p>üíº –ó–∞–ª–∏—à–æ–∫: <b>{{ remaining }} –≥—Ä–Ω</b></p>

    <h3>–í–∏—Ç—Ä–∞—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö:</h3>
    <ul>
        {% for cat, amount in categories_summary.items() %}
            <li>{{ cat }}: {{ amount }} –≥—Ä–Ω ({{ categories_percent[cat] }}%)</li>
        {% endfor %}
    </ul>
</div>

{% elif request.path == '/login' %}
<!-- üîê –í—Ö—ñ–¥ -->
<div class="card auth-card">
    <h2>üîê –í—Ö—ñ–¥</h2>
    <form method="POST" action="/login">
        <input type="text" name="login" placeholder="–í–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω" required>
        <input type="password" name="password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>
        <button type="submit">–£–≤—ñ–π—Ç–∏</button>
    </form>
    <p>–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? <a href="/register">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</a></p>
</div>

{% elif request.path == '/register' %}
<!-- üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è -->
<div class="card auth-card">
    <h2>üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>
    <form method="POST" action="/register">
        <input type="text" name="login" placeholder="–í–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω" required>
        <input type="password" name="password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>
        <button type="submit">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
    </form>
    <p>–í–∂–µ –º–∞—î—Ç–µ –∞–∫–∞—É–Ω—Ç? <a href="/login">–£–≤—ñ–π—Ç–∏</a></p>
</div>

{% endif %}
</main>

<!-- üë§ –ü–†–û–§–Ü–õ–¨ -->
{% if 'user' in session %}
<aside class="side-panel">
    <h3>üë§ –ü—Ä–æ—Ñ—ñ–ª—å</h3>
    <form method="POST" action="/update-profile">
        <label>–õ–æ–≥—ñ–Ω</label>
        <input type="text" value="{{ user.login }}" disabled>
        <label>–ö—Ä–∞—ó–Ω–∞</label>
        <input type="text" name="country" value="{{ user.country }}">
        <label>–°–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥</label>
        <input type="number" name="salary" value="{{ user.salary }}">
        <button type="submit">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    </form>
</aside>
{% endif %}

</div>
</body>
</html>
